<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<script src="https://cdn.jsdelivr.net/npm/vue"></script>
</head>
<body>

	<div id="app">
  <vue-accordion>
    <vue-accordion-item title="first">
      <div>Lorem ipsum dolor sit amet consectetur adipisicing elit. Cupiditate, reprehenderit?</div>
    </vue-accordion-item>
    <vue-accordion-item title="second">
      <div>Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis laboriosam reiciendis cumque voluptate quasi at? Fugit incidunt quo perferendis dolores.</div>
    </vue-accordion-item>
    <vue-accordion-item title="third">
      <div>Lorem ipsum dolor sit amet consectetur adipisicing elit. Harum omnis mollitia ipsam iusto consequatur ea accusantium, laboriosam esse repellendus sapiente officiis nulla odit, consectetur quis enim eius labore, veniam nemo?</div>

      <vue-accordion>
        <vue-accordion-item title="first">
          <div>Lorem ipsum dolor sit amet consectetur adipisicing elit. Cupiditate, reprehenderit?</div>
        </vue-accordion-item>
        <vue-accordion-item title="second">
          <div>Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis laboriosam reiciendis cumque voluptate quasi at? Fugit incidunt quo perferendis dolores.</div>
        </vue-accordion-item>
      </vue-accordion>

    </vue-accordion-item>
  </vue-accordion>
</div>





<script type="text/javascript">
		// console.clear()

Vue.component('vue-accordion', {
  template: '<div class="accordion"><slot /></div>',
  data() {
    return {
      Accordion: {
        count: 0,
        active: null
      }
    }
  },
  provide() {
    return {Accordion: this.Accordion}
  }
})

Vue.component('vue-accordion-item', {
  template: `
    <div class="accordion__item">
      <div 
        class="accordion__trigger"
        :class="{'accordion__trigger_active': visible}"
        @click="open"
        v-html="title"></div>
      <transition 
        name="accordion"
        @enter="start"
        @after-enter="end"
        @before-leave="start"
        @after-leave="end">
        <div class="accordion__wrapper" v-show="visible">
          <div class="accordion__content"><slot /></div>
        </div>
      </transition>
    </div>
  `,
  props: ['title'],
  inject: ['Accordion'],
  data() {
    return {
      index: null
    }
  },
  computed: {
    visible() {
      return this.index == this.Accordion.active
    }
  },
  methods: {
    open() {
      if (this.visible) {
        this.Accordion.active = null
      } else {
        this.Accordion.active = this.index
      }
    },
    start(el) {
      el.style.height = el.scrollHeight + 'px'
    },
    end(el) {
      el.style.height = ''
    }
  },
  created() {
    this.index = this.Accordion.count++
  }
})

new Vue({
  el: '#app'
})
	</script>


	<style>
* {
  box-sizing: border-box;
}

body {
  padding: 50px;
}

.accordion-enter-active, .accordion-leave-active {
  will-change: height, opacity;
  transition: height 0.3s ease, opacity 0.3s ease;
  overflow: hidden;
}

.accordion-enter, .accordion-leave-to {
  height: 0 !important;
  opacity: 0;
}

.accordion__item:last-child .accordion__content {
  border-bottom: solid 1px #e9e9e9;
}
.accordion__trigger {
  padding: 10px 20px;
  background: dodgerblue;
  color: #fff;
  cursor: pointer;
}
.accordion__trigger_active {
  background: #0077ea;
}
.accordion__content {
  padding: 15px 10px;
  border-left: solid 1px #e9e9e9;
  border-right: solid 1px #e9e9e9;
}

</style>
</body>
</html>